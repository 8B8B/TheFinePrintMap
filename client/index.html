<!--
API KEY = AIzaSyCzcplqLGgsRpnPIhCr_1MhVk2qsVNZwcY
-->

<!DOCTYPE html>
<html>

<head>
  <style>
    #map {
      height: 400px;
      width: 100%;
    }

    #floating-panel {
      position: absolute;
      top: 140px;
      left: 25%;
      z-index: 5;
      background-color: #fff;
      padding: 5px;
      border: 1px solid #999;
      text-align: center;
      font-family: 'Roboto', 'sans-serif';
      line-height: 30px;
      padding-left: 10px;
    }

    h3 {
      background-color: lightblue;
      width: 300px;
      border-style: solid;
      padding: 15px;
      padding-bottom: 150px;
      max-height: 75px;
      float: left;
      text-align: center;
      font-family: futura;
      margin: 20px;
    }
  </style>
  <base href="/">
</head>

<body ng-app="directoryApp">
  <br>
  <div class="boxed">
    <form>
      <legend> Toggle Between Different Displays: </legend>
      <p> </p>
      <p>
        <input type="checkbox" name="demographic" value="demographic" id="demographic" onclick="Markers()">
        <label for="demographic"> Demographic Information &emsp; &emsp; &emsp; &emsp; &emsp;
          </label>
        <input type="checkbox" name="routes" value="routes" id="routes">
        <label for="routes"> Bus Routes
          </label>
      </p>
      <p>
        <input type="checkbox" name="comparison" value="comparison" id="comparison" onclick="toggleDiv('floating-panel')">
        <label for="demographic">  Travel Time Comparisons &emsp; &emsp; &emsp; &emsp; &emsp;
          </label>
        <input type="checkbox" name="heatmap" value="heatmap" id="heatmap" onclick="heatMapToggle()">
        <label for="routes"> Heat Map
          </label>
        <!--
        <button class = "dropbtn"> Heat Map <i class= fa fa-caret-down"></i></button>
        <div class = "dropdown-content">
          <button on-click="toggleHeatmap()"> Toggle Heat Map</button>
          <button on-click="changeGradient()"> Change Gradient</button>
          <a href="#">changeGradient()</a>
          <a href="#">changeRadius()</a>
          <a href="#">changeOpacity()</a>
        </div>
        -->


      </p>
    </form>
  </div>

  <div id="floating-panel">
    <script>
      document.getElementById('floating-panel').style.display = 'none';
    </script>
    <b>Start: </b>
    <select id="start">
        <option value="nothing">-- Select one --</option>
    <option value="Reitz Student Union, Gainesville, FL 32603">Reitz Union</option>
    <option value="Butler Plaza RTS Transfer Station, FL 32607">Butler Plaza</option>
    <option value="2-4 W University Ave, Gainesville, FL 32601">Downtown Gainesville</option>
    <option value="Santa Fe College, Gainesville, FL 32606">Santa Fe College</option>
  </select>

    <script>
      function toggleDiv(id) {
        var div = document.getElementById(id);
        div.style.display = div.style.display == "none" ? "block" : "none";
        directionsDisplay1.setMap(null);
        directionsDisplay2.setMap(null);
        directionsDisplay3.setMap(null);
        directionsDisplay4.setMap(null);
      }
    </script>

  </div>

  <div id="map"></div>
  <script>
      //initialized globally for use across functions
      var map, heatmap;
      var radiusClick = false;
      var opacityClick = false;
      var gradientClick = false;
      var trafficLayer, transitLayer, bikeLayer;
      var line;
      var line2;
      var directionsService;
      var directionsDisplay1;
      var directionsDisplay2;
      var directionsDisplay3;
      var directionsDisplay4;
      var directionsDisplay5;
      var directionsDisplay6;
      var directionsDisplay7;
      var lineSymbol;
      var blankimage = 'https://upload.wikimedia.org/wikipedia/commons/c/ca/1x1.png'
      var gainesville = { lat: 29.6516, lng: -82.3248 };
      var zip32601 = { lat: 29.6422516, lng: -82.3289111 };
      var zip32603 = { lat: 29.6577485, lng: -82.3479016 };
      var zip32605 = { lat: 29.6793128, lng: -82.3723105 };
      var zip32606 = { lat: 29.6788293, lng: -82.4644445 };
      var zip32607 = { lat: 29.647247, lng: -82.4156829 };
      var zip32608 = { lat: 29.6156734, lng: -82.3659168 };
      var zip32609 = { lat: 29.7935588, lng: -82.2583297 };
      var zip32641 = { lat: 29.6311155, lng: -82.2365981 };
      var zip32653 = { lat: 29.7429556, lng: -82.3777335 };
      var markers = [];
      function initMap() {
        directionsService = new google.maps.DirectionsService;
        directionsDisplay1 = new google.maps.DirectionsRenderer;
        directionsDisplay2 = new google.maps.DirectionsRenderer;
        directionsDisplay3 = new google.maps.DirectionsRenderer;
        directionsDisplay4 = new google.maps.DirectionsRenderer;
        directionsDisplay5 = new google.maps.DirectionsRenderer;
        directionsDisplay6 = new google.maps.DirectionsRenderer;
        directionsDisplay7 = new google.maps.DirectionsRenderer;
        map = new google.maps.Map(document.getElementById('map'), {
          zoom: 12,
          minZoom: 11,
          maxZoom: 15,
          center: gainesville
        });

        var onChangeHandler = function () {
          if (document.getElementById('start').value == "nothing") {
            directionsDisplay1.setMap(null);
            directionsDisplay2.setMap(null);
            directionsDisplay3.setMap(null);
            directionsDisplay4.setMap(null);
            directionsDisplay5.setMap(null);
            directionsDisplay6.setMap(null);
            directionsDisplay7.setMap(null);
          }
          else {
            directionsDisplay1.setMap(map);
            directionsDisplay2.setMap(map);
            directionsDisplay3.setMap(map);
            directionsDisplay4.setMap(map);
            directionsDisplay5.setMap(map);
            directionsDisplay6.setMap(map);
            directionsDisplay7.setMap(map);
            calculateAndDisplayRoute(directionsService, directionsDisplay1, 1);
            calculateAndDisplayRoute(directionsService, directionsDisplay2, 2);
            calculateAndDisplayRoute(directionsService, directionsDisplay3, 3);
            calculateAndDisplayRoute(directionsService, directionsDisplay4, 4);
            calculateAndDisplayRoute(directionsService, directionsDisplay5, 5);
            calculateAndDisplayRoute(directionsService, directionsDisplay6, 6);
            calculateAndDisplayRoute(directionsService, directionsDisplay7, 7);
          }
        };
        document.getElementById('start').addEventListener('change', onChangeHandler);

        heatmap = new google.maps.visualization.HeatmapLayer({
          data: getPoints(),
          map: map,
          radius: 40,
          opacity: 0.5
        });
        heatmap.setMap(null);
        transitLayer = new google.maps.TransitLayer();
        transitLayer.setMap(map);

        //zipcodes, markers, pop-up windows
        var content32601 = '<div>' + '<p> Zip Code: 32601<br> Population: 18,585 <br> Median Age: 24.4<br> Number of Houses: 9,182<br> Median Income: $24,272<br> Below Poverty Line: 46.90%</p>' + '</div>';
        var info32601 = new google.maps.InfoWindow({
          content: content32601
        });
        var marker32601 = new google.maps.Marker({
          position: zip32601,
          map: map,
          label: '32601',
          icon: blankimage
        });
        marker32601.addListener('click', function () {
          info32601.open(map, marker32601);
        });
        var content32603 = '<div>' + '<p> Zip Code: 32603<br> Population: 6,741 <br> Median Age: 21.1<br> Number of Houses: 2,422 <br> Median Income: $20,080<br> Below Poverty Line: 54.50%</p>' + '</div>';
        var info32603 = new google.maps.InfoWindow({
          content: content32603
        });
        var marker32603 = new google.maps.Marker({
          position: zip32603,
          map: map,
          label: '32603',
          icon: blankimage
        });
        marker32603.addListener('click', function () {
          info32603.open(map, marker32603);
        });
        var content32605 = '<div>' + '<p> Zip Code: 32605<br> Population: 22,925 <br> Median Age: 40<br> Number of Houses: 10,459 <br> Median Income: $69,264<br> Below Poverty Line: 12.10%</p>' + '</div>';
        var info32605 = new google.maps.InfoWindow({
          content: content32605
        });
        var marker32605 = new google.maps.Marker({
          position: zip32605,
          map: map,
          label: '32605',
          icon: blankimage
        });
        marker32605.addListener('click', function () {
          info32605.open(map, marker32605);
        });
        var content32606 = '<div>' + '<p> Zip Code: 32606<br> Population: 21,833 <br> Median Age: 36.8<br> Number of Houses: 10,600 <br> Median Income: $59,122<br> Below Poverty Line: 10.10%</p>' + '</div>';
        var info32606 = new google.maps.InfoWindow({
          content: content32606
        });
        var marker32606 = new google.maps.Marker({
          position: zip32606,
          map: map,
          label: '32606',
          icon: blankimage
        });
        marker32606.addListener('click', function () {
          info32606.open(map, marker32606);
        });
        var content32607 = '<div>' + '<p> Zip Code: 32607<br> Population: 29,750 <br> Median Age: 25.1<br> Number of Houses: 14,802 <br> Median Income: $33,724<br> Below Poverty Line: 35.40%</p>' + '</div>';
        var info32607 = new google.maps.InfoWindow({
          content: content32607
        });
        var marker32607 = new google.maps.Marker({
          position: zip32607,
          map: map,
          label: '32607',
          icon: blankimage
        });
        marker32607.addListener('click', function () {
          info32607.open(map, marker32607);
        });
        var content32608 = '<div>' + '<p> Zip Code: 32608<br> Population: 45,832 <br> Median Age: 28<br> Number of Houses: 23,245 <br> Median Income: $40,465<br> Below Poverty Line: 29.40%</p>' + '</div>';
        var info32608 = new google.maps.InfoWindow({
          content: content32608
        });
        var marker32608 = new google.maps.Marker({
          position: zip32608,
          map: map,
          label: '32608',
          icon: blankimage
        });
        marker32608.addListener('click', function () {
          info32608.open(map, marker32608);
        });
        var content32609 = '<div>' + '<p> Zip Code: 32609<br> Population: 18,756 <br> Median Age: 36.1<br> Number of Houses: 7,999 <br> Median Income: $28,569<br> Below Poverty Line: 32.80%</p>' + '</div>';
        var info32609 = new google.maps.InfoWindow({
          content: content32609
        });
        var marker32609 = new google.maps.Marker({
          position: zip32609,
          map: map,
          label: '32609',
          icon: blankimage
        });
        marker32609.addListener('click', function () {
          info32609.open(map, marker32609);
        });
        var content32641 = '<div>' + '<p> Zip Code: 32641<br> Population: 14,291 <br> Median Age: 34.9<br> Number of Houses: 5,290 <br> Median Income: $30,091<br> Below Poverty Line: 32.80%</p>' + '</div>';
        var info32641 = new google.maps.InfoWindow({
          content: content32641
        });
        var marker32641 = new google.maps.Marker({
          position: zip32641,
          map: map,
          label: '32641',
          icon: blankimage
        });
        marker32641.addListener('click', function () {
          info32641.open(map, marker32641);
        });
        var content32653 = '<div>' + '<p> Zip Code: 32653<br> Population: 13,107 <br> Median Age: N/A<br> Number of Houses: 6,085 <br> Median Income: $64,570<br> Below Poverty Line: N/A</p>' + '</div>';
        var info32653 = new google.maps.InfoWindow({
          content: content32653
        });
        var marker32653 = new google.maps.Marker({
          position: zip32653,
          map: map,
          label: '32653',
          icon: blankimage
        });
        marker32653.addListener('click', function () {
          info32653.open(map, marker32653);
        });
        markers.push(marker32601);
        markers.push(marker32603);
        markers.push(marker32605);
        markers.push(marker32606);
        markers.push(marker32607);
        markers.push(marker32608);
        markers.push(marker32609);
        markers.push(marker32641);
        markers.push(marker32653);
        setMapOnAll(null);
      }

      function heatMapToggle() {
        if (heatmap.getMap() == null)
          heatmap.setMap(map);
        else
          heatmap.setMap(null);
      }

      function calculateAndDisplayRoute(directionsService, directionsDisplay, route) {
        if (route == 1) {
          directionsService.route({
            origin: document.getElementById('start').value,
            destination: 'Majestic Oaks Apartments, Gainesville, FL 32607',
            travelMode: 'TRANSIT'
          }, function (response, status) {
            if (status === 'OK') {
              directionsDisplay.setDirections(response);
            } else {
              window.alert('Directions request failed due to ' + status);
            }
          });
        }
        if (route == 2) {
          directionsService.route({
            origin: document.getElementById('start').value,
            destination: 'Gainesville Place Apartments, Gainesville, FL 32608',
            travelMode: 'TRANSIT'
          }, function (response, status) {
            if (status === 'OK') {
              directionsDisplay.setDirections(response);
            } else {
              window.alert('Directions request failed due to ' + status);
            }
          });
        }
        if (route == 3) {
          directionsService.route({
            origin: document.getElementById('start').value,
            destination: 'Cabana Beach Apartments, Gainesville, FL 32607',
            travelMode: 'TRANSIT'
          }, function (response, status) {
            if (status === 'OK') {
              directionsDisplay.setDirections(response);
            } else {
              window.alert('Directions request failed due to ' + status);
            }
          });
        }
        if (route == 4) {
          directionsService.route({
            origin: document.getElementById('start').value,
            destination: '3527 SW 20th Ave, Gainesville, FL 32607',
            travelMode: 'TRANSIT'
          }, function (response, status) {
            if (status === 'OK') {
              directionsDisplay.setDirections(response);
            } else {
              window.alert('Directions request failed due to ' + status);
            }
          });
        }
        if (route == 5) {
          directionsService.route({
            origin: document.getElementById('start').value,
            destination: 'Tivoli Apartments in Gainesville, Gainesville, FL 32608',
            travelMode: 'TRANSIT'
          }, function (response, status) {
            if (status === 'OK') {
              directionsDisplay.setDirections(response);
            } else {
              window.alert('Directions request failed due to ' + status);
            }
          });
        }
        if (route == 6) {
          directionsService.route({
            origin: document.getElementById('start').value,
            destination: '505 SW 2nd Ave, Gainesville, FL 32601',
            travelMode: 'TRANSIT'
          }, function (response, status) {
            if (status === 'OK') {
              directionsDisplay.setDirections(response);
            } else {
              window.alert('Directions request failed due to ' + status);
            }
          });
        }
        if (route == 7) {
          directionsService.route({
            origin: document.getElementById('start').value,
            destination: 'Rawlings Hall, Gainesville, FL 32603',
            travelMode: 'TRANSIT'
          }, function (response, status) {
            if (status === 'OK') {
              directionsDisplay.setDirections(response);
            } else {
              window.alert('Directions request failed due to ' + status);
            }
          });
        }
      }
      function setMapOnAll(map) {
        for (var i = 0; i < markers.length; i++) {
          markers[i].setMap(map);
        }
      }
      function Markers() {
        if (markers[0].getMap() == null) {
          setMapOnAll(map);
        }
        else {
          setMapOnAll(null);
        }
      }
  </script>

  <h3 id="textBox">
    Select a location and view the difference in travel times and frequency.
  </h3>

  <script>
      //temporary data points
      function getPoints() {
        return [
          //red = 5 min
          //yellow = 10 min
          //green = 15 min
          //oaks mall
          new google.maps.LatLng(29.6574, -82.4114),
          //just north of mall, along newberry rd
          new google.maps.LatLng(29.66, -82.4114),
          //left
          new google.maps.LatLng(29.66, -82.418),
          //right
          new google.maps.LatLng(29.66, -82.414),
          new google.maps.LatLng(29.66, -82.406),
          //bottom
          //new google.maps.LatLng(26.65, 82.40),
          //lakewood apts ~25min
          new google.maps.LatLng(29.6459, -82.4028),

          new google.maps.LatLng(29.6516, -82.3248),
          new google.maps.LatLng(29.6522516, -82.3689111),
          new google.maps.LatLng(29.6472516, -82.4189111),
          new google.maps.LatLng(29.6422516, -82.3289111),
          new google.maps.LatLng(29.6577485, -82.3479016),
          new google.maps.LatLng(29.6793128, -82.3723105),
          new google.maps.LatLng(29.6788293, -82.4644445),
          new google.maps.LatLng(29.647247, -82.4156829),
          new google.maps.LatLng(29.6156734, -82.3659168),
          new google.maps.LatLng(29.7935588, -82.2583297),
          new google.maps.LatLng(29.6311155, -82.2365981),
          new google.maps.LatLng(29.7429556, -82.3777335)
        ];
      }
  </script>
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCzcplqLGgsRpnPIhCr_1MhVk2qsVNZwcY&libraries=visualization&callback=initMap">

  </script>
</body>

</html>